# 一、项目开发规范

## 1 开发工具：

编辑器：vscode，微信开发者工具，HBuildX，代码缩进2个空格

vscode快捷键

```
！+  tab：生成基本骨架
ctrl + + ctrl + -：放大缩小字体
标签名 + tab或者回车：生成双标签
标签名*n + tab或者回车：生成n个相同双标签
鼠标定到某行可以只复制一行
鼠标定到某行，ctrl  +  /：注释和取消注释当前行
标签>标签 + tab：生成包含     标签+标签 + tab：生成并列
标签名.类名 + tab：生成该类名的标签，不加标签默认为div
标签名#id名 + tab：生成该id名的标签，不加标签默认为div
.类名$*n：生成连续类名      标签名{文本}：生成包含文本的标签，文本为$则生成连续数字
CSS可以缩写+tab生成                shift+alt+F：格式化代码
```

其他：浏览器，snipaster，phontoshop，cmder，marktext

操作系统：

目前大量的库，js语法等，在win7支持的最高node版本13.14.0已经不支持，需要更高版本的系统。

vue谷歌浏览器调试工具：vue.js devtools，vue2和vue3使用的版本不一样，为了避免冲突，使用时只保留一个，禁用另一个。

vscode插件：

（1）代码格式化：prettier

能够格式化html，css，js，ts，vue等代码

（2）vue语法、代码提示插件

vetur：vue2使用

volar：vue3使用

为了避免冲突，使用时只保留一个，禁用另一个。

## 2 HTML/CSS/JS规范：

代码缩进：2

Web标准：结构（HTML），表现（CSS），行为（Javascript）

- HTML尽量用语义化标签替代div，属性使用双引号，若属性很多可以换行
  
  ```
  <div 
    aaa="xx" 
    bbb="xxx"
  > 
  </div>
  ```

- css属性按规范的顺序书写，css3中属性值小数0.5可写.5，css属性顺序：display=定位-盒子-文本-文
  
  字-背景-C3

- js字符串使用双引号，每个语句结尾加分号（加了分号避免不必要的错误，尤其是ts）

## 

## 3 各种命名规范

HTML本身没有驼峰标识（标签名、属性无法识别大写，但是属性的值可以），脚手架才会有

css，js，ts都有驼峰标识

* 无驼峰标识的情况下，HTML属性，组件名组件标签，以xxx-yyy命名，有驼峰标识了也尽量使用 xxx-yyy的形式，css类名id名也常用xxx-yyy命名

* js，ts驼峰命名法：变量/函数/对象小驼峰，构造函数/类/接口/组件/大驼峰

* js、ts变量只能用数字、字母、下划线、$命名，且不能数字开头，也不能用-命名，组件标签以xxx-yyy命名时，注意js不能用-命名。

* 子组件以views组件名开头（如HomeMain.vue），hook函数useXXX

## 4 运算符、符号规范

运算符左右两边空一格：

```
let a = 5 + 7;
```

逗号，冒号后空一格：

```
let a = [123, 456];
let b = {a: 123};
```

## 5 Vue目录结构规范：

```
src
  assets
    img
    css
  common        本项目公用的js文件
    components  公共组件
    common    可以在别的项目用的组件
    content   只能在本项目用的组件
  views       各个页面独立的组件
  router
  store
  network
  App.vue
  main.js
...
package.json
vue.config.js
tsconfig.json
```

## 6 开发前准备

（1）拿到.editorconfig文件，配置代码风格
（2）创建vue.config.js，配置路径别名，当成绝对路径用

```
module.export = {
  configurewebpack:{
    resolve:{
      extension:[], //配置后倒入路径可不加后缀，默认已配载就hi，可不写。
      alias:{
        '@':'src',  //默认已配置，可不写
        'assets':'@/assets',
        'components':'@/components',
        'common':'@/common',
        'network':'@/network',
        'views':'@/views'
      }
    }
  }
}
```

（3）初始化CSS

Github下载normalize.css，统一不同浏览器的html标签模样
②创建base.css，@import “assets/css/normalize”; 并初始化css
然后在App.vue中的script，@import “assets/css/base.css”;

# 二、常用布局和业务逻辑

## 1 整体布局

（1）PC端：

- 普通页面，header+居中版心+footer，header和footer与浏览器同宽

- 后台管理系统，居中版心（左（aside）+右（header+content））

（2）移动端：

手机和电脑连一个wifi，手机进入 电脑ip:端口

- 限制屏幕缩放的最大与最小宽度

- 顶部导航+滚动（单滚动或左分类+有内容）+tabBar，开发时页面分类tabBar页面和非tabBar页面，导航栏和tabBar可以根据路由动态显示隐藏荐vw

（3）根据页面v-if，v-show动态显示对应内容

如登录页和404页隐藏全局的一些模块

如移动端的导航栏和tabbar可以根据判断路由来动态显示

- 必须做适配，推

## 2 常用模块

（1）轮播图：

（2）移动端搜索框：

点击假的搜索盒子进入搜索页面，进入时候自动获得焦点

## 3 常用布局

（1）圣杯布局

（2）分栏布局

（3）水平滑动切换/点击切换布局

切换回来时，高度可以保持也可以到最开始

（4）瀑布布局

## 4 常用业务逻辑

（1）上拉加载更多

正在加载时，应该用一个if阀口来判断是否正在加载中，只有在非加载状态时才发送请求

不能用防抖节流

上拉加载最后一页的判断，服务器返回一般两种：
①状态码，根据状态码判断就行
②返回总数，此时可以用 页码*每页数量>=总数来判断，也可以当前总数>=总数来判断

（2）注册/登录/权限管理

详见node笔记

（3）支付

（4）后台管理

管理员拥有全部权限，用户不是注册来的而是管理员添加的，用户可修改密码。
管理员主要有对用户、角色、权限、菜单的管理，用户具备角色的权限+管理员单独给的权限=该用户权限列表。

一般初始不需要默认路由，初始只需要配置登录页面，404页面等基本页面的路由，其他路由和默认路由都根据权限动态添加。

# 三、项目前端性能优化

为了项目稳定，在出现错误时不停止服务，在可能出错的代码用try...catch...做异常处理。

减少DOM操作

预加载

精灵图：整合了小图标，较少服务器请求次数
代码压缩（打包）：将代码丑化，去除空格和换行

1 按需引入

在使用任何东西时，若果能够按需引入就一定要按需引入，会提升很多性能，如Vue3的CompositionsAPI，组件库/字体图标/echarts等等的按需引入。

Vue3和一些第三方库都有自动按需引入的插件，自动按需引入就是不需要自己手动import {} 来引入，当代码写到的时候就会自动引入。

2 第三方库的开发时和运行时

npm装包时，默认是安装运行时依赖，只有加上参数-dev时才会安装开发时依赖。

在装包的时候需要考虑该包是否需要在项目运行时使用，弱不需要就安装开发时依赖，这也是提升性能的一个点。

3 SEO优化

TDK：都放在head标签中

```
<title>网站名(产品名)-介绍(不要超过30个汉字)</title>
<meta name=”description” content=”网站详细说明，服务，特色，电话等”>
<meta name=”keywords” content=”英文逗号隔开的6-8个关键词，方便搜索引擎搜索”>
```

2 懒加载

图片懒加载（必用）

```
# 在图片需要在屏幕上显示时，才加载图片，优化性能。
npm install --save vue-lazyload 

//main.js
impoet VueLavyLoad from 'vue-lazyload'
Vue.use(VueLazyLoad,{
  //此对象可写可不写，用来设置加载时显示的图片，加载失败时的图片等
})
```

路由懒加载（必用）

第三方库或组件懒加载（可选）

3 精灵图，字体图标

4 防抖与节流

5 logo

```
logo优化规范：h1提高重要性，a返回首页
<div class=”logo”>
    <h1><a href=”index.html” title=”网站名称” >网站title</a></h1>
</div>
a的背景图片设置为logo，a里面的文字是为了被搜索引擎收录，但是为了美观需要隐藏：
font-size: 0; 或 text-indent: -99999px;  overflow: hidden;
```

6 favicon图标

```
favicon图标：
一般作为缩略的网站标志，显示在浏览器的地址栏或标签上。
将png的图片转换成.ico格式的图片并放到项目根目录中 https://www.bitbug.net/
引入：必须在放在head标签
<link rel=”shortcar icon” href=”xx.ico” type=”image/x-icon”>
```

# 四、项目部署到Linux服务器

node开发的后端启动后就行

vue项目需要先打包，打包得到的所有文件放到了另一个express项目的public文件夹中，并修改访问端口为80，然后npm start

## 1 环境搭建

购买云服务器，修改密码，开放端口，连接ssh

windows上的cmd：

```
ssh root@服务器ip
```

windows的cmd非常不好用，推荐自行下载cmder

连接到服务器后，配置Linux服务器的系统环境

```
//1.更新yum，并且安装常用软件
yum update
yum install -y gcc gcc-c++ cmake ncurses ncurses-devel bison

//2.node，通过编译源代码安装，
cd /usr/src 这里专门存放源代码
wget https://nodejs.org/dist/v9.3.0/node-v9.3.0.tar.gz
tar -xf node-v9.3.0.tar.gz
cd node-v9.3.0
./configure
make && make install
//编译完成，程序放在 /usr/local

//3.更新node到最新版本，n也可以款速切换node版本
npm install -g n
//不要用n latest安装最新版本，最新版本node17不稳定
n 14 安装node14
n的使用：https://segmentfault.com/a/1190000015302680

//4.python装包：
pip3 install --upgrade pip
pip3 install numpy==1.19.3
pip3 install pandas==0.23.4
pip3 install matplotlib

//5.创建公钥，并安装git：
cd ~/.ssh
ssh-keygen -t rsa -C "邮箱" 回车执行，再回车三次
cat ~/.ssh/id_rsa.pub 复制输出得到内容到github
//安装git：
yum install git
git config --global user.name "xxx"
git config --global user.email "xxx"
```

## 2 后台运行服务，开机自启

为了同时启动vue和node，且断开ssh连接不结束服务，需要将他们挂到后台中

```
yum -y install screen

screen -ls    #查看当前已创建的会话 数字.会话名 是-r 的xxx
screen -S xxx #创建xxx会话并进入，在里面 ctrl+a+d 离开当前会话并挂载后台， 输入exit则删除该会话并退出
screen -r xxx #进入xxx会话
```

## 3 Linux可能遇到的问题

（1）解决刷新后找不到网页的问题：

```
npm install --save connect-history-api-fallback
```

```
const history = require('connect-history-api-fallback')
...
app.use(history())
```

（2）windows和Linux回车符不同的问题

（3）若想用Linux命令行执行某个程序时传递参数

命令行的参数有个数和长度限制，所以参数多可以将参数保存到txt文件，读写这个文件获取参数

（4）编码问题
在上传/创建/读取/写入文件时，一定要首先考虑编码，否则遇到中文出现bug非常难发现

（5）linux中没有中文字体SimHei

所以 plt.rcParams['font.sans-serif'] = ['SimHei'] 无效，以下python代码查看现有字体

```
from matplotlib import font_manager
a = sorted([f.name for f in font_manager.fontManager.ttflist])
for i in a:
 print(i)
```

解决方法：

将win系统的 c:/windows/fonts 下的字体copy到linux，放到linux系统并情空系统字体缓存，放到matploylib文件中并修改配置文件，清空matplotlib字体缓存。

（6）python程序相关

node用exec调用python程序的问题：

exec的er回调中，服务器会停在这里，需要 return next(err)  或直接return  来继续运行服务器。

中文问题：

linux中py代码注释若有中文会报错（即使是注释也会），解决：最前面加上 #coding=utf-8
