# 一、绪论

## 1 概念

网络包括计算机网络，电话网络等。

计算机网络是计算机技术和通信技术的结合，它将分散的、具有独立功能的计算机系统，通过通信设备与线路连接起来，由功能完善的软件实现资源共享和信息传递的系统，是一个互连的、自治的计算机集合。

计算机网络的功能：

最重要得到就是数据通信和资源共享。

* 数据通信

* 资源共享，包括硬件资源、软件资源、数据资源

* 分布式处理，即多台计算机共同承担一个工作任务的不同部分

* 提高可靠性，假如一台主机当机使这条链路走不通了，那另一条链路的主机可以成为它的替代机

* 负载均衡，即分布式处理达到的效果，一个工作均衡分配给各台计算机

## 2 计算机网络组成

组成部分：

* 硬件，主要包括主机（即端系统）、链路、通信设备

* 软件、即安装在端系统的软件，如系统程序的FTP，应用程序的QQ、微信

* 协议，计算机网络的核心，一系列规则和约定的结合，保证计算机网络安全平稳可靠的进行数据传输

工作方式：

分为边缘部分和核心部分

* 边缘部分即主机，即用户可以直接使用的，进行通信主要有客户端和P2P两种方式

* 核心部分，主要是为边缘部分服务的，包含大量路由器和网络

功能组成：

根据数据通信和资源共享分为通信子网和资源子网，分别实现数据通信和资源共享，也可以统一说成对数据的处理。

通信子网对应OSI七层模型的物理层-数据链路层-网络层

资源子网对应OSI七层模型的会话层-表示层-应用层

中间的传输层是两个子网的接口

## 3 计算机网络的分类

按照分布范围可以分为：

* 广域网（WAN），是一个很大的范围，通常会跨国，使用交换技术

* 城域网（MAN），覆盖一个城市

* 局域网（LAN），比较小的范围，如一个教室是一个局域网，使用广播技术

* 个人区域网（PAN），个人的电子设备互联的区域

按使用者可以分为：公用网和专用网

* 公用网主要有中国移动、中国电信、中国联通等

* 专用网，在军队、政府、银行等内部使用，必须具备权限才能使用

按交换技术可以分为：电路交换、报文交换和分组交换

按拓扑结构可以分为：总线型、星型、环型和网状型，拓扑结构指的是将网络中的设备抽象为一个点，链路抽象为一个直线形成的图，网状型通常用于广域网（如因特网），星型的节点数=链路数+1

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-22-15-58-16-image.png)

按传输技术可以分为：广播式网络和点对点网络

* 广播式网络，指所有的主机可以共享一个通信信道，一台主机通过这个信道传输数据时，其他主机都可以接收到，每台主机会进行判断看目的地之是不是传输给自己的，若是就接收，不是就丢弃

* 点对点网络，使用分组存储转发和路由选择机制，一对一的通信

## 4 计算机网络标准化工作和相关组织

法定标准：

国内外规定的法定标准，如OSI七层模型

事实标准：

随着一些列的商业竞争，角逐出一些协议和标准就，成为了民间认可的事实上的标准，如TCP/IP协议

RFC（Request For Contents）：

因特网标准的一种形式，但不代表所有的RFC都是因特网标准。RFC要成为因特网标准需要经历3个阶段（2011年之前是4个阶段）：

1. 因特网草案，根据构思你定一个草案，以邮件的形式发给RFC

2. 建议标准，若草案不错，草案会成为RFC文档，随后就可以请求评论了，放到因特网上得到一些建议和修改，完善后得到草案标准，给相关组织审核

3. 成为因特网标准

标准化工作的相关组织：

* ISO（国际标准化组织），主要贡献是OSI参考模型和HDLC协议；

* ITU（国际电信联盟），主要贡献是指定了通信规则；

* IEEE（国际电气电子工程师协会），是一个学术机构，主要贡献是IEEE802系列标准，5G标准；

* IETF（Internet工程任务组），负责因特网相关标准的指定，如RFC；
1. ## 5 计算机网路熊性能指标

（1）速度指标

① 速率

表示计算机网络的快慢，通常指数据率（也叫数据传输率或比特率），速率即数字信道上传输数据位数的速率，单位有b/s，kb/s，Mb/s，Gb/s，Tb/s。

比特（bit）：计算机数据的最小单位，一个比特代表0或1，速率单位是小写b小写k，如kb/s，Mb/s

字节（Byte）：1个字节 = 8个比特，速率单位是大写B大写K，其他不变，如KB/s，MB/s

此外，这里的速率单位之间是1000倍的关系而不是1024倍，在存储容量方面才是1024倍。

② 带宽

原先中是指某个信号剧透的频带宽度（最高频率与最低频率之差，单位hz），因为原先大多是传输模拟信号

但是现在大多数是传输数字信号，所以带宽的概念发生了变化，现在指的是网络的通信线路传输数据的能力，通常是单位时间内从网络某一点到另一点所能通过的最高数据率（也可以理解为网络设备支持的最高速度），单位和速率一样，单位之间也是1000倍的关系。

③ 吞吐量

单位时间内，通过某网络/信道/接口的数据量之和，单位和速率一样，单位之间也是1000倍的关系。

如CD传输数据到B，C的速率是10Mb/s，D的速率是20Mb/s，那么B的吞吐量就是30Mb/s

```
        | --- C
A --- B -
        | --- D
```

④ 总结

速率是单位时间能传多少数据，带宽是能够支持的最大速率，吞吐量是通过某个地方（这个地方可能有多条链路经过）的数据量之和（速率之和）。

（2）时间指标

① 时延

数据/比特流/报文/分组从链路一端到另一端的时间，单位s，分为四个部分

场景：A --- 路由器 --- B    A发送数据给B    

* 发送时延（也叫传输时延），A从发送分组到信道上的覅一个比特开始算起，到该分组的最后一个比特发送到信道完毕所苏姚的时间。
  
  公式：发送时延 = 比特数 / 速率  （但是做题时一般给的是带宽，所以做题要 * 带宽）

* 传播时延，电磁波在信道上传播的时间
  
  公式：传播时延 = 信道长度 / 电磁波速率  （电磁波速率由于阻力一般达不到光速）

* 排队时延，等待输出/输入到链路需要的时间，如这里输入路由器，路由器输出的时间，这段时间数据会存到路由器的缓存里

* 处理时延，数据检错纠错寻址的时间，如这里发生在路由器内部

减少时延的方法是提高发送速率或带宽，以此减少发送时延；而电磁波的速率一般变不了；所以高速链路指的是发送速率块。

计算总时延把四个加起来即可。

② 时延带宽积

公式：时延带宽积  = 传播时延 * 发送带宽  （单位：s * bit/s = bit）

描述数据量/信息量的多少，即此时此刻在信道中的所有比特数，因此也称为以比特为单位的链路长度。

③ 往返时延RTT

发送方发送第一个比特到信道上开始，到发送方从信道上收到接收方第一个比特的确认为止的时间。RTT越大，收到确认之前可以发送的数据越多，因为等确认的时间久且会一直发送。

可以在终端ping一下得到RTT：

```
ping www.baidu.com
```

公式：RTT = 2 * 传播时延 + 末端处理时间  （注意不包括发送时延）

④ 利用率

* 信道利用率 = 有数据通过时间 / (有 + 无)数据通过时间

* 网络利用率 = 信道利用率加权平均值

利用率也不宜太高，否则会造成堵塞增大时延

## 6 计算机网络分层结构

计算机网络体系结构时各层及其协议的集合。

实体：每一层的活动元素，同一层的实体互为对等实体，第n层的实体叫n层实体

协议：一系列的规则或约定，只有对等实体之间才有协议

接口：每两层之间的关口

服务：每两层之间提供的东西，计算机网络中是上层使用下层的服务

分层基本原则：

* 各层之间相互独立，每层只能实现一种相对独立的功能

* 每层的界限清晰，易于理解，相互交流尽可能少

* 分层时，每层采用最合适的技术实现

* 保持下层对上层的独立性，上层单向使用下层的服务

* 分层结构应该能促进标准化工作

（1）七层OSI参考模型

法定标准的分层模型，但是市场使用以及用户体验没有四层模型好，所以很少使用

自下而上分别是：物理层-数据链路层-网络层-传输层-会话层-表示层-应用层

通信子网对应下三层，资源子网对应上三层。

（2）四层TCP/IP模型

自下而上分别是：网络接口层-网际层-传输层-应用层

（3）五层模型

结合七层/四层模型的优点得到的新分层模型

自下而上分别是：物理层-数据链路层-网络层-传输层-应用层

# 二、应用层

网络体系结构的最上层，应用程序之间的通信。

规定：

* 需要规定应用进程的报文类型（请求报文/响应报文）

* 需要规定各种报文的语法

* 需要规定字段的语义，以及包含在字段中的信息的含义

* 需要规定进程何时、如何发送报文，以及对报文相应的规则

功能：

* 文件的传输、访问和管理，协议有FTP，TFTP

* 电子邮件，协议有SMTP，POP3，IMAP

* 虚拟终端，协议有HTTP

* 查询服务和远程作业登录，协议有DNS

## 1 网络应用模型

（1）客户/服务器模型（Client/Server）

把网络的节点分为客户机和服务器两种角色，客户机就是用户使用的计算机，用户可以请求服务器的服务；服务器就是提供服务的计算机。

服务器特点：

* 永久提供服务

* 永久性的访问地址/域名

客户机特点：

* 与服务器通信，使用服务器的服务

* 间歇性接入网络

* 可能使用的是动态的ip地址

* 不与其他客户机直接通信，需要借助服务器转发

（2）P2P模型（Peer-to-peer，也叫对等模型）

没有服务器，只有主机，整个网络传输的内容都不会保存到服务器上，每个主机都具有上传和下载的功能，它们的权利和义务都是对等的。

特点：

* 没有永久的服务器

* 主机都可以提供服务和请求服务

* 主机之间可以直接通信

* 主机都可以间歇性的接入网络

* 主机可能使用动态的ip地址

* 可扩展性好，不像服务器有容量限制

* 网络健壮性强，不容易瘫痪，不像服务器瘫痪了整个服务都瘫痪了

# 2 域名解析系统DNS

客户机是通过ip地址找到服务器的，但是ip地址不好记，所以就有了域名。域名是ip地址的一个别名。比如 www.baidu.com 就是一个域名

域名由数字、字母、点等构成，用点分隔出一个个标号，如com就是一个标号，每个标号最多不能超过63个字符（为了方便也不要超过12个字符），每个标号不区分大小写。标号的等级从右至左，级别由高到低，分别是顶级域名，二级域名，三级域名......

此外，顶级域名之上还有一个根，根一般省略不写，如 www.baidu.com 的完整写法是 www.baidu.com.  最后面的点后面就是根。

顶级域名分类：

| 顶级域名分类         | 说明                                                                                        |
| -------------- | ----------------------------------------------------------------------------------------- |
| 国家顶级域名         | 如cn，us，uk等，分别是中国、美国、英国等                                                                   |
| 通用顶级域名         | com（公司企业），net（提供信息的机构），org（非营利性组织），gov（政府），int（国际组织），aero（航空企业），museum（博物馆），travel（旅游业）等等 |
| 基础结构域名（也叫反向域名） | arpa，用ip地址反向解析为域名                                                                         |

二级域名分类：

这里的二级域名也可以作为顶级域名

| 二级域名分类         | 说明                                                                    |
| -------------- | --------------------------------------------------------------------- |
| 类别域名           | ac（科研机构），com（工商金融），edu（教育），gov（政府），mil（中国国防），net（提供信息的机构），org（非营利性组织） |
| 行政区域名          | 各个省市等的域名                                                              |
| 自己注册的二级域名或三级域名 | 必须全球唯一，如 baidu                                                        |

顶级域名和二级域名有重复的部分，是用于顶级域名为国家级域名的场景，如 org.cn

域名树：

根作为根结点，顶级域名为第二层，以此类推构成一个域名树，书写域名时，从最低级开始书写。

因为使用了域名，计算机就需要有一个将域名解析为ip地址的功能，这就是DNS（域名解析系统）。通过DNS服务器来解析域名。

DNS服务器：

* 在域名树上的DNS服务器有：根域名服务器，顶级域名服务器，权限域名服务器，全球共有13个根域名DNS服务器（域名分别是 a.rootserver 到 m.rootserver），一个权限域名服务器对应一个区（如 abc.com 和 x.abc.com 分别对应两个区的两个权限域名服务器，abc 和 x.abc 是同级的）

* 不在域名树上的DNS服务器：本地域名服务器（也叫默认域名服务器），离主机最近（不超过几个路由器），本地域名服务器的存在可以使距离比较近的主机通信可以直接诶在本地域名服务器内解析，而不用进入域名树查询

解析过程：

1. 操作系统检查缓存和本地的hosts文件，看该url是否有记录ip地址，有的话就完成解析；否则就继续下一步。

2. 使用TCP/IP参数中设置的DNS服务器进行查询，如果查找的域名包含在本地配置区域资源中，则返回解析结果完成解析；否则继续下一步。

3. 检查本地DNS服务器是否缓存该url记录，有就完成解析；否则继续下一步。

4. 到此处，就分为迭代查询和递归查询两种方式了，无论哪种方式，查到结果后都会高速缓存到本地域名服务器和主机中，缓存会定期更新。
   
   * 迭代查询（靠自己），本地DNS服务器发送查询报文到根DNS服务器，根DNS服务器收到后，返回顶级根DNS服务器地址，随后本地DNS服务器发送查询报文到顶级根DNS服务器，顶级根DNS服务器返回权威DNS服务器的地址，随后本地DNS服务器再发送请求报文到权威DNS服务器，权威DNS服务器收到后就会返回最终的ip地址，完成解析。
   
   * 递归查询（靠别人），本地->根->顶级->权限（得到ip地址）->顶级->根->本地

## 3 文件传输协议FTP

TFTP（简单文件传输协议）：内存占用小且易于实现，面向小文件的传输协议。适用于UDP环境，如需要将程序/文件同时给许多机器下载时就用到TFTP；还适用于小型计算机或特殊用途的设备

FTP：

基于客户/服务器模型的协议，可以提供不同种类的主机系统（硬件/软件都可以不同）之间文件传输的能力，如windows系统传文件给Linux系统。FTP功能有上传和下载。客户机可以连接远程的FTP服务器并遵循FTP协议传输文件

FTP传输模式：文本模式（ASCI），二进制模式（Binary）

FTP工作原理：

1. 登录FTP服务器，输入FTP服务器的ip地址、用户名和密码。此外，互联网上也有很多匿名的FTP服务器可以匿名登录，

2. 建立TCP连接，客户机和FTP服务器是可以多对多，且FTP服务器的一个进程也可以为多个客户机的进程服务。FTP进程由唯一的主进程和n个从属进程组成
   
   * 唯一的主进程：负责接收新的请求
   
   * n个从属进程：每个从属进程都可以为一个客户机进程服务。控制进程和数据进程也属于从属进程

3. 主进程打开FTP服务器的熟知端口21，控制进程在21端口建立控制连接->等待客户机发起连接请求（发给服务器的控制进程）->客户进程连接熟知端口->打开从属进程->传输数据（与服务器的数据进程在20端口建立数据连接），控制连接是一直连接的，而数据连接只有传输数据时才连接。数据连接如果是主动模式就是20端口，被动模式就由客户和服务器协商决定（通常大于1024）
   
   * 主动模式：建立连接找到熟知端口21，主动告诉客户机在服务器的端口20建立数据连接
   
   * 被动模式：建立连接找到熟知端口21，随后客户机发送一个命令给服务器，询问服务器的数据连接端口号，客户机在用这个端口建立数据连接

## 4 电子邮件

（1）电子邮件的信息格式

* 信封，包括收件人的邮箱等）

* 内容，包括首部（发给谁和主题等），和主体

（2）电子邮件系统的组成结构

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-27-01-08-27-image.png)

* 用户代理：用户和电子邮件系统的接口，通常是邮箱程序，功能是提供给用户撰写、显示、处理、通信四个功能

* 邮件服务器：功能是邮件服务器之间发送和接收邮件（因此邮件服务器可以充当客户/服务器两种角色），和报告给发件人传送结果。

* 协议：SMTP和POP3、IMAP
  
  * SMTP：在客户发送邮件到邮件服务器，邮件服务器发送邮件给邮件服务器时使用
  
  * POP3和IMAP：在邮件服务器接收，客户机接收时使用

（3）电子邮件系统工作原理

* 发送方通过用户代理写邮件，并发给发送方的邮件服务器的缓存里（SMTP协议，TCP连接）

* 若发送方邮件服务器可以发送了，就从发送方的邮件服务器缓存中取出，并发送给收件方的邮件服务器的缓存里（SMTP协议，TCP连接诶）

* 若接收方邮件服务器可以发送了，从缓存取出，发给收件方用户代理，用户代理接收（POP3协议或IMAP协议，TCP连接）

（4）电子邮件的协议

① MTP（简单邮件传送协议）

使用TCP连接，端口号25，使用客户/服务器模型

规定了在两个相互通信的SMTP进程之间应该如何交换信息。

负责发送邮件的SMTP进程SMTP客户，负责接收邮件的SMTP进程就是SMTP服务器。每个邮件服务器可以作为客户也可以作为服务器。

SMTP规定了14条命令（每个命令由几个字母组成）和21中应答信息（3位数字+简单英文说明）。

SMTP之间的通信，分三个阶段：

1. 建立TCP连接：发送方写邮件，发送到发送方的SMTP服务器缓存中
   
   * 发送方SMTP服务器每隔一段时间扫描一次缓存，若发现有邮件就是要SMTP协议，25端口与接收方的SMTP服务器建立TCP连接
   
   * 接收方SMTP服务器发出应答信息220 Service ready 表示可以传输了
   
   * SMTP客户向SMTP服务器发送一个helo命令，并附上发送方的主机名
   
   * SMTP服务器若有能力接收，就发 250 ok 给SMTP客户；若三天内不能接收邮件，就发回 421 Sevice not availble

2. 传送邮件：
   
   * A发送 MAIL FROM 和 发件人邮箱，B成功就返回 250 OK，失败返回451
   
   * A发送一个或多个RCPTTO命令，和发件人邮箱，B成功就返回 250 OK，失败返回550
   
   * A发送DATA命令，表示可以正式发送邮件了，B返回354
   
   * A发送Date，发邮件，B接收，B接收
   
   * A发送完，发CRLF 表示传输结束，B返回 250 OK，传输结束

3. 连接释放：A发 QUIT 命令，B返回 211 ，释放连接

SMTP缺点：

* 不能传输可执行文件或其它的二进制对象

* SMTP只支持7位比特的ASCI，也就是说不能传除了英语之外的语言

* SMTP服务器会拒绝一定长度的邮件

为了解决这些缺点，就有了MIME（通用因特网邮件扩充）：

在SMTP协议上扩充邮件内容长度的一种手段，且会将非ASCI的内容转为ASCI，支持可执行文件，音乐，多种语言。目前MIME也应用于浏览器。

② POP3协议（邮局协议）

在接收邮件时使用，TCP连接，端口号110，客户/服务器模型，接收方邮件服务器作为POP3客户，用户代理作为POP3服务器。

两种工作方式：

* 接收方邮件服务器从缓存读取出来邮件后，下载并继续保留

* 接收方邮件服务器从缓存读取出来邮件后，从缓存中删除

不管是下载还是删除，都不是很方便，所以在后期也使用MIME进行扩充

③ IMAP协议（网际报文存取协议）

由于POP3功能有限，就有了IMAP协议。

当用户主机的IMAP程序打开IMAP服务器的邮箱时，用户先可以看到邮件首部，只有要打开邮件时，才会上传到主机。并且用户可以在不同地方不同主机打开邮件的某个部分，需要的时候再查看其它部分或下载附件

（5）基于万维网的电子邮件

目前使用的邮件方式，进入网站就可以直接使用电子邮件

* 发送方用户代理到发送方邮件服务器不再使用SMTP协议，而是http协议

* 发送方邮件服务器到接收方邮件服务器还是SMTP协议

* 接收方邮件服务器到接收方用户代理使用IMAP协议

## 5 万维网和http协议

### 5.1 万维网

万维网（www，World Wide Web）

客户/服务器模型，万维网是大规模的，联机式的信息储藏所，是全球的网站、网页的集合。如果需要访问这些资源，就需要url（统一资源定位符），url唯一标识万维网的资源。万维网通过HTML能很方便跳转界面，并在屏幕上显示出来

url格式： 协议://主机:端口/路径

* url不区分大小写

* 常用的协议有ftp协议，http协议，https协议

* 主机就是域名，也可以直接写ip

* 端口号可以省略，省略后位80

通过点击超链接或浏览器输入url，通过http协议就能访问资源

### 5.2 http协议

http协议（超文本传输协议）

详细规定了浏览器和万维网服务器之间互相通信的规则，主要是规定了请求(request)和响应(response)两块内容。

浏览器向服务器发送请求，发送内容是请求报文，服务器响应返回的内容是响应报文。

（1）用户点击超链接或输入url后的过程

* DNS解析

* 与服务器80端口建立TCP连接

* 发送http请求，服务器返回文档

* 显示文档（可以只下按时部分资源，如视频可以播放再请求过来）

* 释放TCP连接

（2）http协议特点：

* 无状态：每次进入网页都是初始内容；但是实际使用中，可能需要状态保持，如保持登录状态。此时可以使用本地的cookie文件保存状态

* 使用TCP连接，但是http协议本身是无连接的，在http请求和相应之前不需要建立http连接

* http协议的TCP连接有持久连接和非持久连接，持久连接又分为流水线式的持久连接（可以同时发请求，相应会依次返回）和非流水线的持久连接（一个请求有相应之后才能继续发请求）

（3）http协议报文结构

分为http请求报文和http相应报文

请求报文结构：

开始行又叫请求行，首部行又叫请求头，只有回车的哪一行是请求空行必须有的，实体主体又叫请求体。

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-27-01-10-48-image.png)

相应报文结构：

开始行又叫相应行，首部行又叫相应头，只有回车的哪一行是请求空行必须有的，实体主体又叫相应体。

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-27-01-11-40-image.png)

请求鲍文文示例：

Conection: close 表示非持久连接

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-27-01-12-54-image.png)

状态码：

| 1xx | 服务器收到，需要请求者继续执行 100:服务器收到POST的Header，需要请求者再发送data |
| --- | ------------------------------------------------- |
| 2xx | 表示成功，一般是200                                       |
| 3xx | 重定向，需要进一步操作来完成请求 301:资源/网页被永久转移到其他url             |
| 4xx | 客户端错误，请求有语法错误或无法完成请求 404:请求的资源/网页不存在              |
| 5xx | 服务器错误，服务器在处理请求过程中发生错误 500:内部服务器错误                 |

请求方式：

有post、put，get、delete等，分别对应增改查删（CURD）

GET和POST是最常用的两种请求类型。
http协议层面上看基本区别：

1. 都是http的请求方式，底层都是TCP/IP协议

2. 通常GET产生一个TCP数据包，POST产生两个TCP数据包。在网络好的情况下，发一个两个数据包速度没有太大差异，GET/POST都可使用；但是在网络差的情况下，GET可定比POST速度快。

3. GET会把Header和data一起发送，服务器返回200则成功；POST先发送Header，等服务器返回100后再发送data，服务器返回200则成功。

4. GET请求通常通过url来获取数据，POST请求通常通过表单来发送数据

5. GET请求和POST请求都可以传递参数

使用上的区别：

1. 最本质区别：GET的参数包含在url，POST的参数在请求体中

2. GET请求参数有大小限制且只能接受Ascll编码的数据且格式只能url编码，POST请求参数没有大小限制且没有数据的类型限制且有多种格式(也支持url编码)

3. GET参数显示在url上，安全性隐私性差，不适合传递敏感数据，POST在请求体中更安全

4. GET请求会保留在浏览器历史记录中且可bookmark(收藏/书签)，而POST不会

5. GET请求在刷新/回退网页时，无影响；而POST会再次发送请求，因此GET效率更高

6. GET请求会被缓存，POST请求不会被缓存，所以GET效率更高

（4）http协议版本

http1.1最常用，http2是比较新的版本

http1.1之后，请求默认都是流水线的持久连接

早期的http都是非持久连接，所以每次请求都要反复建立断开连接，非常消耗性能。在1997年http1.1发布之后加入了持久连接，只需要建立一次连接在里面进行多次的请求响应，不需要重复建立断开连接，提升了数据传输的效率。

此外，http1.1还推出了流水线式的持久连接（管道机制），在一个连接中可以并发发送多个请求，但是响应不是并发的。http2后响应也是并发的。

（5）https协议

https请求则会在TCP和http之间多添加一层协议作为加密以及认证的服务。https使用SSL和TLS协议保证信息的安全。

SSL协议：认证客户端和服务器，确保数据发送到正确的客户端和服务器，加密数据并维护数据的完整性。

TSL协议：用于在两个通信应用程序之间，提供保密性和数据完整性。TSL由TSL记录协议和TSL握手协议组成。

# 三、传输层

# 四、网络层

# 五、数据链路层

# 六、物理层

## 1 基本概念

物理层是解决如何在连接各种计算机的传输媒体上传输数据比特流，而不是指具体的传输媒体（光纤，同轴电缆，双绞线，无线等）。物理层不关心传输媒体的具体细节，只管本层次的内容、设备和下层的传输媒体的接口。所以传输媒体也可以叫第0层。

物理层特性：

- 机械特性：定义物理连接的特性，规定物理连接所采用的规格、接口形状‘引线数目、引脚数量和排列情况等

- 电气特性：规定传输二进制位时，线路上信号的电压范围、阻抗匹配、传输速率和距离限制等

- 功能特性：指明某条线上出现的某个电平表示何种意义，接口部件信号线的用途，注意电气特性的电压范围指的是某范围内表示高还是低电平，而功能特性则是指高低电平表示什么意义

- 规程特性（也叫过程特性）：各条物理线路的工作规程和时序关系

## 2 通信基础之概念

电话、电报、网络等等都算是数据通信的范畴。

网络有两种入网方式：

* 电话线入网，早期的入网方式，电话线上传输的是模拟信号，而计算机发送/接收的是数字信号，所以在发送和接收时需要调制解调器进行数模转换

* 宽带网络入网，网络上传输的是数字信号

数据通信基本概念：

* 通信：母的是为了传输信息

* 数据：是传递信息的实体，通常是有意义的符号序号，如比特流

* 信号：数据的电气电磁的表现，是数据在传输过程中的存在形式，分为数字信号和模拟信号。
  
  数字信号：参数取值是离散的。
  
  模拟信号：参数取值是连续的。

* 信源：发送数据的源头

* 信宿：接收数据的终点

* 信道：传输信号的媒介，表示一个方向的传输恓的介质，因此信道包括往返方向信道，信号只有在信道上才能传输。
  
  根据传输的信号类型可以分为：数字信道，模拟信道。
  
  根据传输介质可以分为：有线信道，无线信道。

通信方式：

* 单工通信：只有一个方向的通信，没有反方向的交互，因此只有一条方向的信道，即只发不收。常见的有广播。

* 半双共通信：通信双方都可以发送和接收，但是不能同时发送和接收，具有两条信道。常见的有对讲机。

* 全双工通信：通信双方都可以发送和接收，并且可以同时发送和接收，具有两条信道。常见的有手机。

数据传输方式：

* 串行传输：一个个比特排队传输，适合远距离的传输因为费用低
  
  优点：只需要往返两条信道、费用低。
  
  缺点：速度慢

* 并行传输：可以同时发送多个比特进行传输，适合于近距离传输因为费用高
  
  优点：速度快
  
  缺点：需要很多条信道，费用高

## 3 通信基础之码元

（1）码元：

数据需要变为数字信号才能在信道中传输。

码元是用一个固定时长的信号波形（也叫数字脉冲），来代表不同离散数值的一个基本波形。它是数字通信中数字信号的计量单位，这个时长内的信号称为k进制码元，该时长称为码元宽度。

二进制码元：1个码元1个比特，有0和1两种状态

四进制码元：1个码元2个比特，有00/01/10/11四种状态

k进制码元以此类推

（2）速率：

也叫数据率，指数据的传输速率，表示单位时间内发送到信道上的数据量，可以用码元传输速率和信息传输速率表示。注意这个是发送速率而不是传播速率。

* 码元传输速率（码元速率/波形速率/调制速率/符号速率）：单位时间内数字通信系统内传输的码元个数（脉冲个数/信号变化次数），单位波特（Baud），1波特表示数字通信系统每秒传输一个码元，码元速率与码元进制数无关。
  
  相同的码元速率，传输的比特数可能不同，因为一个码元的比特数可能不同

* 信息传输速率（信息速率/比特率）：单位时间内数字通信系统传输二进制码元个数或比特数，n bit的码元，码元速率为m Baud，那信息传输速率为 吗 * n bit/s

（3）带宽

表示单位时间内从网络的某一点到另一点所能通过的最高数据率，常用来表示网络的通信新线路传输数据的能力，单位 bit/s，是通信线路支持的最高速率。

（4）习题

四进制码元4s内传输了8000个码元，则：

* 四进制码元，一个码元2个比特，4中状态00、01、10、11

* 码元传输速率 = 8000 / 4 = 2000(Baud)

* 信息传输速率 = 2 * 2000 = 2 * 8000 / 4 = 4000(bit/s)

## 4 通信基础之数据编码和信号调制

（1）基本概念

信号在信道传输的两种形式：

* 基带信号：将数字信号的0和1用两种不同的电压表示，再送到信道上进行基带传输，来自信源的信号就是基带信号，因此基带信号可以是数字信号和模拟信号，但是在计算机网络中基带信号因为计算机发出的都是0和1，所以只能是数字信号，所以计算机网络中的基带信道都是数字信道

* 宽带信号：将基带信号载波调制后把信号的频率范围移到较高的频段，形成的频分复用的模拟信号，在模拟信道上传输，仅在一段频率范围内能够通过信道。高频的信号可以应对信号衰减很大的环境，即使衰减了，接收端也可以过滤出来

距离短时使用基带信号传输，因为距离短信号衰减小

距离远使用宽带信号传输

（2）编码

计算机发出的0和1就是数字数据，声音等就是模拟数据，不管是什么数据需要变成信号才能在信道传输，编码就是：

* 使用数字发送器将数字数据编码成数字信号

* 使用PCM编码器将模拟数据编码成数字信号

数字数据编码成数字信号：

用于基带传输，基本不改变数字信号的频率

| 编码方式     | 说明                                                                                                                  |
| -------- | ------------------------------------------------------------------------------------------------------------------- |
| 非归零编码    | 高1低0（不推荐使用），优点是容易实现，缺点是没有检错功能且无法判断码元的开始和结束，导致收发双方难以保持同步，如无法判断连续的1和连续的0到底有多少个1和0，所以需要发送方另外建立一条信道发送给接收方时钟周期来算出多少个1和0, |
| 曼彻斯特编码   | 前高后低为1，前低后高位0（一般规定是这样，也有可能是反过来，得看规定），每次都有跳变相当于同时传输了时钟周期（自同步）。由于一个码元分割为前后两个相等的间隔，因此二进制码元信息传输速率是码元速率的一半               |
| 差分盲测斯特编码 | 左边虚线左右相同为1，左边虚线左右不同为0，常用于局域网，特性和曼彻斯特编码一样，但是差分的抗干扰性更强                                                                |
| 归零编码     | 归零为1，0处不变为0（不推荐使用），由于很长时间会处于0，接收方也很难判断连续的0有几个0                                                                      |
| 反向不归零编码  | 不跳变为1，跳变为0（不推荐使用），如果是连续的0会一直跳变，接收方很好判断；如果是连续的1则一直不变，接收方判断不出有几个1                                                     |
| 4B/5B编码  | 每4个比特都插入一个比特变成5个比特的编码，具体如何编码比较复杂不需要了解。编码效率为80%                                                                      |

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-26-15-33-05-image.png)

<img title="" src="file:///C:/Users/Administrator/AppData/Roaming/marktext/images/2022-10-26-15-35-47-image.png" alt="" width="641">

模拟数据编码成数字信号：

使用PCM编码，编码过程为抽样，量化，编码。

| PCM编码步骤 | 说明                                                                                                |
| ------- | ------------------------------------------------------------------------------------------------- |
| 抽样      | 对模拟信号进行周期性的扫描，把事件上连续的信号变为时间上离散的信号。为了使得将这些离散信号无失真的代表被抽样的模拟数据，要使用采样定理进行采样 （采样定理：采样频率 >= 2 * 信号最高频率） |
| 量化      | 把抽样取得的电平幅值按照一定的分级标准转化为对应的数字值并取整，这样就把连续的电平幅值转化为了离散的数字值                                             |
| 编码      | 将量化的结果转化为对应的二进制编码                                                                                 |

（3）调制

计算机发出的0和1就是数字数据，声音等就是模拟数据，不管是什么数据需要变成信号才能在信道传输，调制就是：

* 使用调制器将数字数据调制成模拟信号

* 使用放大调制器将模拟数据调制成模拟信号

数字数据调制成模拟信号：

| 调制方式 | 说明                                                                        |
| ---- | ------------------------------------------------------------------------- |
| ASK  | 调幅，1有振幅，0没有振幅                                                             |
| FSK  | 调频，1频率高，0频率低                                                              |
| PSK  | 调相，1和0各自对应正弦波或余弦波                                                         |
| QAM  | 正交振幅调制，调幅和调相的结合，可以是调幅后再细分几个相位，也可以是调相后细分几个幅度。幅度数 * 相位数 = 状态树 = 2^k (k进制码元) |

![](C:\Users\Administrator\AppData\Roaming\marktext\images\2022-10-26-15-40-30-image.png)

模拟数据调制成模拟信号：

为了实现传输的有效性，需要较高的频率，这种调制方式还可以使用频分复用技术，充分利用带宽资源。在电话机和本地交换机所传输的信号是采用模拟信号传输模拟数据的方式，模拟的声音数据是加载到模拟的在波奇中传输的。

## 5 通信基础之奈氏准则和香农定理

（1）基本概念

噪声与信噪比：

噪声存在于所有的电子设备和通信信道中。由于噪声随机产生，它的瞬时值有时会很大，因此噪声会使接收端对码元的判决产生错误，但是噪声的影响是相对的，若信号较强，那相对的噪声的影响就变小了，因此引出了信噪比的概念，来衡量噪声对信道的影响程度。

信噪比 = 信号的平均功率 / 噪声的平均功率，单位S/N或不带单位，但是S/N的数值有时候可能很大，为了直观，有时会使用分贝（db）为单位，db = 10log(10)(S/N)

db和S/N都是信噪比，。只是表示形式不同。

失真：

信号在传输的时候比起原始传的信号发生了扭曲和变化。

造成失真的原因：

* 码元传输速率，信号失真的程度就越严重

* 信息传输距离越长，信号衰减就越久，干扰越久

* 噪声干扰越多越容易失真

* 传输介质质量越差，失真越严重

信道频宽：

也叫信道带宽，注意这个带宽和之前笔记的带宽概念不同（之前笔记的是信号带宽，指信道支持的最高速率），这里的带宽指的是信号的最高频率和最低频率之差，单位为hz。

信号频率越快，表明码元变化的越快，即码元速率越快

* 过低的信号频率，非常容易衰减，接收端收不到信号

* 过高的信号频率，会造成码间串扰，接收端区分不出波形的差异，失去了码元之间清晰的界限

（2）奈氏准则（也叫奈奎斯特定理）：

在理想低通，条件下，为了避免码间串扰，极限码元传输速率为2W Baud，W为信道带宽（hz）。理想指无噪声无干扰，低通指信道带宽受限，低于最高频率的频率可以通过的意思。

即奈氏准则求的是最高码元传输速率。

推论：

* 根据最高码元传输速率，配合给出的状态数V（状态数可以求出k进制码元，k = logV），就能得出最高信息传输速率（最高数据传输率） = 2W * logV (biy/s)

* 信道带宽越大，码元速率越快，因为带宽越大，频率范围越大，可以传输更高频率（更高码元速率）的信号

* 只限制了码元速率，没有限制信息传输速率，为了提高信息传输速率，需要提高每个码元携带的信息量，即k进制码元k变大

习题：信道信道3000hz，4个相位，每个相位4种振幅，求最大数据率：

最大数据率 = 2 * 3000 * log(4*4) = 24000bit/s = 24kb/s

无噪声，

（3）香农定理：

在带宽受限，有噪声的信道中，为了不产生误差，信息传输速率有一个上限值：

最高信息传输速率 =  W * log(1+S/N)，单位为bit/s ，W为信道带宽，S/N为信噪比

即香农定理求的是最高信息传输速率。

推论：

* 只要信息传输速率小于最高信息传输速率就符合香农定理，一定有方法实现无差错的传输

* 信道带宽越大，最高信息传输速率越大

* 信道带宽和信噪比确定了，最高信息传输速率就确定了

习题：

信道带宽3000hz，信噪比30db，求最大数据传输率：

S/N = 10 ^ (30/10) = 1000

最大数据集传输率 ≈ 3000 * log(1+1000) ≈ 30000(bit/s) = 30kb/s

（4）两个公式哦如何选用

如果题目出现了带宽和信噪比/状态数来就最高信息传输速率，用香农定理/奈氏准则，如果信噪比和状态数都给了，就两个公式都求一下，为了稳定取两者的较小值。如：

二进制信号，信噪比127，4kHZ信道，求最高数据率

奈氏准则结果 = 2 * 4000 * 1 = 8000bit/s = 8kb/S

香农定理结果 = 4000 * log(1+127) = 28000bit/s = 28kb/s

所以最高数据率为8kb/s

## 6 传输介质

传输介质也叫传输媒体/传输媒介，即数字传输系统中发送设备和接收设备之间的一条实际存在的物理通路（信道是抽象出来的逻辑通路）。

需要注意的是，传输介质不是物理层的内容，而是物理层下一层（第0层）的内容，传输介质中传输的信号但是传输介质本身不知道传输的信号代表的意思，纯粹只作为传输的线路；而物理层规定了电气特性，所以知道传输的是比特流。

传输介质分类：

* 导向性的传输介质（也叫导引）：电磁波被导向沿着传输介质进行传输，介质可以是铜线、光纤等。
  
  1. 双绞线：最古老，最常用，价格便宜的传输介质，局域网/电话网普遍使用，数字传输/模拟传输都可使用，通信距离寄几公里到几十公里。双绞线由两根采用一定规则并排绞合、相互绝缘铜导线组成。两条线电流相反，绞合在一起是为了抵消两条导线的电磁干扰。带水晶头的绿色网线就是非屏蔽就是由4组双绞线组合而成的
     
     | 双绞线类型       | 结构                                                     |
     | ----------- | ------------------------------------------------------ |
     | 无屏蔽双绞线（UTP） | 从内到外方分别是两根铜导线、绝缘层和聚氯乙烯（塑料）套层                           |
     | 屏蔽双绞线（STP）  | 从内到外方分别是两根铜导线、绝缘层、金属丝编织的屏蔽层和聚氯乙烯（塑料）套层。屏蔽层可以进一步减少电磁干扰。 |
  
  2. 同轴电缆，由导体铜质芯线、绝缘层、网状编织屏蔽层和塑料外层组成。导体就是铜线，可以是单条也可以使多条绞合而成。抗干扰新比双绞线更强，传输速率更大，传输距离更远，但是价格更贵
     
     | 同轴电缆分类 | 说明               |
     | ------ | ---------------- |
     | 基带同轴电缆 | 传输基带信号，主要用于局域网等  |
     | 宽带同轴电缆 | 传输宽带信号，主要用于有线电视等 |
  
  3. 光纤（光导纤维），传输的是光脉冲/光波（双绞线和同轴电缆传输的是电脉冲/电磁波）。带宽非常大噶，通信量很大，所以频率可以很高，速度会很快，且体积小重量轻。需要在发送端/接收端进行光电转换将电脉冲转化为光脉冲，发送端使用光源来转换（可以是发光二极管，或半导体激光器），接收端使用光电二极管做成的光感应器还原为电脉冲。
     
     光纤由实心的纤芯和包层组成，光波通过纤芯传导，纤芯的折射率很高，包层的折射率低一些，当光波从高折射率的介质射入到低折射率的介质，折射角会大于入射角，而入射角足够大就会发生全反射，即光线碰到包层就反射，损耗很小。因此光纤可以应用于长距离传输。
     
     光纤抗雷电和抗电磁干扰新强，保密性也强
     
     | 光纤分类 | 说明                                                           |
     | ---- | ------------------------------------------------------------ |
     | 多模光纤 | 传输多条光波，通过全反射传输，光源是发光二极管，虽然全反射损耗很很小，但随着距离越长，损耗也可能大到无法接受       |
     | 单模光纤 | 光纤的直径小到只有一条光波能通过，光源是定向性很好的激光二极管，光不是全反射而是直射，损耗几乎没有，适合非常长的距离传输 |

* 非导向性的传输介质（也叫非导引）：在自由空间中进行传输，介质可以是真空、空气、海水等。
  
  1. 无线电波，信号会向所有方向船舶，因此在有效距离内接收方无需在固定的方向与发送端进行通信，简化了通信连接。穿透性较强可以实现远距离传输，广泛应用于无线局域网、手机通信等。
  
  2. 微波，信号沿直线传输，是视线介质的一种，频段是三者最高的，因此速率最快。应用于卫星通信和地面微波接力通信，应用原理都是通过中继站来转发微波，如只需要3个卫星就能实现全球通信，卫星通信的通信量大、距离远、覆盖广并可以实现广播通信的多址通信，但是时延较长，容易受天气影响，卫星造价贵。
  
  3. 红外线和激光，信号沿直线传输，是视线介质的一种。需要将信号转换为红外光信号/激光信号（而微波不需要转换）

## 7 物理层的设备

（1）中继器

信号在传输的时候会受到干扰而衰减，衰减到一定程度就失真，接收端就无法正确还原数据。为了避免信号衰减，就有了中继器。

中继器的功能是将进行再生和还原，对衰减的信号进行放大来保持与源数据相同或非常接近，从而增加信号传输的距离，延长网络的长度和覆盖范围。

中继器有两个端口，一进一出：

* 两端的网络是网段不是子网，网段必须相同，不会存储转发因此两端网段的协议必须相同，网段的速率必须相同

* 仅作用于信号的电气部分，并不会管错误数据和不适于网段的数据

* 两端的传输介质可以相同，也可以不同

5-4-3规则：

网络标准中对网络延迟范围做了规定，因此中继器只能在规定的范围进行，否额网络会故障。如信号经过非常多的中继器，每个中继器处理的时间加起来就很多，网络延迟就很大。

因此，需要对中继器的使用做限制，在10M以太网中：

* 5：最多不超过5个网段

* 4：5个网段内，最多只能有4个物理层设备

* 3：只有3个端可以连接计算机

（2）集线器

多端口的中继器，星型拓扑结构。在中继器功能基础上，通过连接多台计算机简洁延长了计算机之间的传输距离并扩展网络的长度和范围，再生还原后信号会发送到除输入端口外，且处于工作状态的计算机，因此集线器是广播通信，没有定向传播能力，是一个共享设备。

计算机收到信号后，是给自己的就处理，不是给自己的就丢弃。

由于每台计算机都要发送数据，因此同时发信号可能会产生冲突，遇到冲突就停下，等待一个随机时间后，再各自发送信号，直到没有冲突为止，工作效率比较低。

集线器在同一个时钟周期内只能实现一组通信，若有n台计算机同时发信号，那它们分到的带宽只有1/n的总带宽。

# 七、网络安全
